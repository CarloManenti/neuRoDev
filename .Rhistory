#'
#' @return A list of SingleCellExperiment objects with one element per group
#'
#' @examples
#' m <- matrix(sample(seq(1,10, length.out=10000), 15000*100, replace = TRUE), ncol = 100)
#' rownames(m) <- paste0('Gene-', seq(1,15000))
#' colnames(m) <- paste0('Col-', seq(1,100))
#' net <- SingleCellExperiment::SingleCellExperiment(assays = list(logcounts = m))
#' net$SubClass <- rep(c('A', 'B', 'C', 'D'), each = 25)
#' split_sce_cols(net, net$SubClass)
split_sce_cols <- function(sce, colVec) {
groups <- as.character(sort(unique(colVec)))
temp.sce.split <- lapply(groups, function(i) sce[,colVec==i])
names(temp.sce.split) <- groups
return(temp.sce.split)
}
get_average_subclass_vs_stage(net = net, genes = rownames(m)[seq(1,3)])
?assays
#'
#' @return A matrix with the average expression by subclass and stage
#'
#' @examples
#' m <- matrix(sample(seq(1,10, length.out=10000), 15000*100, replace = TRUE), ncol = 100)
#' rownames(m) <- paste0('Gene-', seq(1,15000))
#' colnames(m) <- paste0('Col-', seq(1,100))
#' net <- SingleCellExperiment::SingleCellExperiment(assays = list(logcounts = m))
#' net$SubClass <- rep(c('A', 'B', 'C', 'D'), each = 25)
#' net$Stages <- rep(c('S1', 'S2', 'S3', 'S4'), each = 25)
get_average_subclass_vs_stage <- function(net, genes) {
genes <- genes[which(genes %in% rownames(net))]
networkByStage <- split_sce_cols(net, net@colData[,"Stages"])
o <- lapply(networkByStage, function(i) {
S <- SummarizedExperiment::assays(i)[['logcounts']][genes,]
S <- t(scale(t(S)))
return(split(Matrix::colMeans(S),i@colData[,"SubClass"]))
}
)
o <- lapply(o, function(j) sapply(j, median))
groupVarOrder <- sort(unique(net@colData[,"SubClass"]))
o <- do.call(rbind, lapply(o, function(i) i[groupVarOrder]))
colnames(o) <- groupVarOrder
o[is.na(o)] <- 0
return(o)
}
get_average_subclass_vs_stage(net = net, genes = rownames(m)[seq(1,3)])
#' subclass-stage pairs
#'
#' @examples
#' m <- matrix(sample(seq(1,10, length.out=10000), 15000*100, replace = TRUE), ncol = 100)
#' rownames(m) <- paste0('Gene-', seq(1,15000))
#' colnames(m) <- paste0('Col-', seq(1,100))
#' net <- SingleCellExperiment::SingleCellExperiment(assays = list(logcounts = m))
#' net$SubClass <- rep(c('A', 'B', 'C', 'D'), each = 25)
#' net$Stages <- rep(c('S1', 'S2', 'S3', 'S4'), each = 25)
#' get_eMatrix(net = net, genes = rownames(net)[seq(1,5)])
get_eMatrix <- function(net, genes, nRand=100) {
#' subclass-stage pairs
#'
#' @examples
#' m <- matrix(sample(seq(1,10, length.out=10000), 15000*100, replace = TRUE), ncol = 100)
#' rownames(m) <- paste0('Gene-', seq(1,15000))
#' colnames(m) <- paste0('Col-', seq(1,100))
#' net <- SingleCellExperiment::SingleCellExperiment(assays = list(logcounts = m))
#' net$SubClass <- rep(c('A', 'B', 'C', 'D'), each = 25)
#' net$Stages <- rep(c('S1', 'S2', 'S3', 'S4'), each = 25)
#' get_eMatrix(net = net, genes = rownames(net)[seq(1,5)])
get_eMatrix <- function(net, genes, nRand=100) {
Test <- get_average_subclass_vs_stage(net, genes)
RandSets <- lapply(seq(1,nRand), function(i) {sample(rownames(net), length(genes))})
RandSets <- lapply(RandSets, function(i) {get_average_subclass_vs_stage(genes=i, net = net)})
Ave <- do.call("cbind",lapply(seq(1,ncol(RandSets[[1]])), function(j) Matrix::rowMeans(do.call(cbind, lapply(RandSets, function(i) i[,j])))))
SDs <- do.call("cbind",lapply(seq(1,ncol(RandSets[[1]])), function(j) apply(do.call(cbind, lapply(RandSets, function(i) i[,j])), 1, sd)))
z <- (Test-Ave)/SDs
p <- 2 * stats::pnorm(-abs(z))
return(S4Vectors::List(z=z, p=p))
}
get_eMatrix(net = net, genes = rownames(net)[seq(1,5)])
emat <- get_eMatrix(net = net, genes = rownames(net)[seq(1,5)])
emat$z
emat$p
#' @export
#'
#' @examples
#' m <- matrix(sample(seq(1,10, length.out=10000), 15000*100, replace = TRUE), ncol = 100)
#' rownames(m) <- paste0('Gene-', seq(1,15000))
#' colnames(m) <- paste0('Col-', seq(1,100))
#' net <- SingleCellExperiment::SingleCellExperiment(assays = list(logcounts = m))
#' net$SubClass <- rep(c('A', 'B', 'C', 'D'), each = 25)
#' net$Stages <- rep(c('S1', 'S2', 'S3', 'S4'), each = 25)
#' plot_eMatrix(net = net, genes = rownames(net)[seq(1,5)])
plot_eMatrix <- function(net, genes, nRand=100, eMatrix = NULL) {
if(is.null(eMatrix)) {
eMatrix <- get_eMatrix(net = net, genes = genes, nRand = nRand)
}
z <- eMatrix$z
col_fun <- circlize::colorRamp2(
breaks = c(min(z, na.rm = TRUE), 0, max(z, na.rm = TRUE)),
colors = c("blue", "white", "red")
)
stages_palette <- unique(net$Stages_color)
names(stages_palette) <- unique(net$Stages)
right_ha <- ComplexHeatmap::rowAnnotation(stage = names(stages_palette), col = list(stage = stages_palette), show_legend = FALSE, show_annotation_name = FALSE)
ComplexHeatmap::Heatmap(z, cluster_rows = FALSE, cluster_columns = FALSE, col = col_fun, right_annotation = right_ha, show_row_names = FALSE, width = grid::unit(ncol(z)*4, 'mm'), height = grid::unit(nrow(z)*4, 'mm'), name = 'enrichment(z)')
}
m <- matrix(sample(seq(1,10, length.out=10000), 15000*100, replace = TRUE), ncol = 100)
rownames(m) <- paste0('Gene-', seq(1,15000))
colnames(m) <- paste0('Col-', seq(1,100))
net <- SingleCellExperiment::SingleCellExperiment(assays = list(logcounts = m))
net$SubClass <- rep(c('A', 'B', 'C', 'D'), each = 25)
net$Stages <- rep(c('S1', 'S2', 'S3', 'S4'), each = 25)
plot_eMatrix(net = net, genes = rownames(net)[seq(1,5)])
unique(net$Stages) :
unique(net$Stages)
stages_palette <- c('S1' = 'pink', 'S2' = 'orange', 'S3' = 'violet', 'S4' = 'black')
net$Stages_color <- stages_palette[net$Stages]
plot_eMatrix(net = net, genes = rownames(net)[seq(1,5)])
rm(list = c('split_sce_cols', 'get_eMatrix', 'plot_eMatrix', 'get_average_subclass_vs_stage'))
devtools::as.package()
devtools::document()
devtools::check()
devtools::check()
devtools::document()
devtools::build()
devtools::install()
?mean
m <- matrix(sample(seq(1,10, length.out=10000), 15000*100, replace = TRUE), ncol = 100)
rownames(m) <- paste0('Gene-', seq(1,15000))
colnames(m) <- paste0('Col-', seq(1,100))
net <- SingleCellExperiment::SingleCellExperiment(assays = list(logcounts = m))
net$SubClass <- rep(c('A', 'B', 'C', 'D'), each = 25)
net$Stages <- rep(c('S1', 'S2', 'S3', 'S4'), each = 25)
genes <- 'Gene-1'
genes <- genes[which(genes %in% rownames(net))]
networkByStage <- split_sce_cols(net, net@colData[,"Stages"])
#'
#' @return A list of SingleCellExperiment objects with one element per group
#'
#' @examples
#' m <- matrix(sample(seq(1,10, length.out=10000), 15000*100, replace = TRUE), ncol = 100)
#' rownames(m) <- paste0('Gene-', seq(1,15000))
#' colnames(m) <- paste0('Col-', seq(1,100))
#' net <- SingleCellExperiment::SingleCellExperiment(assays = list(logcounts = m))
#' net$SubClass <- rep(c('A', 'B', 'C', 'D'), each = 25)
#' neuRoDev:::split_sce_cols(net, net$SubClass)
split_sce_cols <- function(sce, colVec) {
groups <- as.character(sort(unique(colVec)))
temp.sce.split <- lapply(groups, function(i) sce[,colVec==i])
names(temp.sce.split) <- groups
return(temp.sce.split)
}
networkByStage <- split_sce_cols(net, net@colData[,"Stages"])
o <- lapply(networkByStage, function(i) {
S <- SummarizedExperiment::assays(i)[['logcounts']][genes,]
if(length(genes) == 1) {
S <- (S-mean(s))/stats::sd(s)
return(split(S, i@colData[,"SubClass"]))
}
S <- t(scale(t(S)))
return(split(Matrix::colMeans(S),i@colData[,"SubClass"]))
}
)
o <- lapply(networkByStage, function(i) {
S <- SummarizedExperiment::assays(i)[['logcounts']][genes,]
if(length(genes) == 1) {
S <- (S-mean(S))/stats::sd(S)
return(split(S, i@colData[,"SubClass"]))
}
S <- t(scale(t(S)))
return(split(Matrix::colMeans(S),i@colData[,"SubClass"]))
}
)
o
o <- lapply(o, function(j) sapply(j, stats::median))
groupVarOrder <- sort(unique(net@colData[,"SubClass"]))
o <- do.call(rbind, lapply(o, function(i) i[groupVarOrder]))
colnames(o) <- groupVarOrder
o[is.na(o)] <- 0
#' @return A matrix with the average expression by subclass and stage
#'
#' @examples
#' m <- matrix(sample(seq(1,10, length.out=10000), 15000*100, replace = TRUE), ncol = 100)
#' rownames(m) <- paste0('Gene-', seq(1,15000))
#' colnames(m) <- paste0('Col-', seq(1,100))
#' net <- SingleCellExperiment::SingleCellExperiment(assays = list(logcounts = m))
#' net$SubClass <- rep(c('A', 'B', 'C', 'D'), each = 25)
#' net$Stages <- rep(c('S1', 'S2', 'S3', 'S4'), each = 25)
#' neuRoDev:::get_average_subclass_vs_stage(net = net, genes = rownames(m)[seq(1,3)])
get_average_subclass_vs_stage <- function(net, genes) {
genes <- genes[which(genes %in% rownames(net))]
networkByStage <- split_sce_cols(net, net@colData[,"Stages"])
o <- lapply(networkByStage, function(i) {
S <- SummarizedExperiment::assays(i)[['logcounts']][genes,]
if(length(genes) == 1) {
S <- (S-mean(S))/stats::sd(S)
return(split(S, i@colData[,"SubClass"]))
}
S <- t(scale(t(S)))
return(split(Matrix::colMeans(S),i@colData[,"SubClass"]))
}
)
o <- lapply(o, function(j) sapply(j, stats::median))
groupVarOrder <- sort(unique(net@colData[,"SubClass"]))
o <- do.call(rbind, lapply(o, function(i) i[groupVarOrder]))
colnames(o) <- groupVarOrder
o[is.na(o)] <- 0
return(o)
}
#' @export
#'
#' @examples
#' m <- matrix(sample(seq(1,10, length.out=10000), 15000*100, replace = TRUE), ncol = 100)
#' rownames(m) <- paste0('Gene-', seq(1,15000))
#' colnames(m) <- paste0('Col-', seq(1,100))
#' net <- SingleCellExperiment::SingleCellExperiment(assays = list(logcounts = m))
#' net$SubClass <- rep(c('A', 'B', 'C', 'D'), each = 25)
#' net$Stages <- rep(c('S1', 'S2', 'S3', 'S4'), each = 25)
#' emat <- get_eMatrix(net = net, genes = rownames(net)[seq(1,5)])
get_eMatrix <- function(net, genes, nRand=100) {
Test <- get_average_subclass_vs_stage(net, genes)
RandSets <- lapply(seq(1,nRand), function(i) {sample(rownames(net), length(genes))})
RandSets <- lapply(RandSets, function(i) {get_average_subclass_vs_stage(genes=i, net = net)})
get_eMatrix(net, genes)
warnings()
Test <- get_average_subclass_vs_stage(net, genes)
RandSets <- lapply(seq(1,nRand), function(i) {sample(rownames(net), length(genes))})
nRand=100
RandSets <- lapply(seq(1,nRand), function(i) {sample(rownames(net), length(genes))})
RandSets <- lapply(RandSets, function(i) {get_average_subclass_vs_stage(genes=i, net = net)})
Ave <- do.call("cbind",lapply(seq(1,ncol(RandSets[[1]])), function(j) {
Matrix::rowMeans(do.call(cbind, lapply(RandSets, function(i) i[,j]))))
Ave <- do.call("cbind",lapply(seq(1,ncol(RandSets[[1]])), function(j) {
Matrix::rowMeans(do.call(cbind, lapply(RandSets, function(i) i[,j])))
}))
SDs <- do.call("cbind",lapply(seq(1,ncol(RandSets[[1]])), function(j) {
apply(do.call(cbind, lapply(RandSets, function(i) i[,j])), 1, stats::sd)
}))
z <- (Test-Ave)/SDs
p <- 2 * stats::pnorm(-abs(z))
j <- 1
do.call(cbind, lapply(RandSets, function(i) i[,j]))
#' @export
#'
#' @examples
#' m <- matrix(sample(seq(1,10, length.out=10000), 15000*100, replace = TRUE), ncol = 100)
#' rownames(m) <- paste0('Gene-', seq(1,15000))
#' colnames(m) <- paste0('Col-', seq(1,100))
#' net <- SingleCellExperiment::SingleCellExperiment(assays = list(logcounts = m))
#' net$SubClass <- rep(c('A', 'B', 'C', 'D'), each = 25)
#' net$Stages <- rep(c('S1', 'S2', 'S3', 'S4'), each = 25)
#' emat <- get_eMatrix(net = net, genes = rownames(net)[seq(1,5)])
get_eMatrix <- function(net, genes, nRand=100) {
Test <- get_average_subclass_vs_stage(net, genes)
RandSets <- lapply(seq(1,nRand), function(i) {sample(rownames(net), length(genes))})
RandSets <- lapply(RandSets, function(i) {get_average_subclass_vs_stage(genes=i, net = net)})
Ave <- do.call("cbind",lapply(seq(1,ncol(RandSets[[1]])), function(j) {
Matrix::rowMeans(do.call(cbind, lapply(RandSets, function(i) i[,j])))
}))
SDs <- do.call("cbind",lapply(seq(1,ncol(RandSets[[1]])), function(j) {
apply(do.call(cbind, lapply(RandSets, function(i) i[,j])), 1, stats::sd)
}))
z <- (Test-Ave)/SDs
p <- 2 * stats::pnorm(-abs(z))
return(S4Vectors::List(z=z, p=p))
}
get_eMatrix(net, genes)
plot_eMatrix(net, genes)
genes
m <- matrix(sample(seq(1,10, length.out=10000), 15000*100, replace = TRUE), ncol = 100)
rownames(m) <- paste0('Gene-', seq(1,15000))
colnames(m) <- paste0('Col-', seq(1,100))
net <- SingleCellExperiment::SingleCellExperiment(assays = list(logcounts = m))
net$SubClass <- rep(c('A', 'B', 'C', 'D'), each = 25)
net$Stages <- rep(c('S1', 'S2', 'S3', 'S4'), each = 25)
stages_palette <- c('S1' = 'pink', 'S2' = 'orange', 'S3' = 'violet', 'S4' = 'black')
net$Stages_color <- stages_palette[net$Stages]
plot_eMatrix(net = net, genes = rownames(net)[seq(1,5)])
plot_eMatrix(net = net, genes = rownames(net)[seq(1)])
warnings()
eMatrix <- get_eMatrix(net = net, genes = genes, nRand = nRand)
z <- eMatrix$z
col_fun <- circlize::colorRamp2(
breaks = c(min(z, na.rm = TRUE), 0, max(z, na.rm = TRUE)),
colors = c("blue", "white", "red")
)
stages_palette <- unique(net$Stages_color)
names(stages_palette) <- unique(net$Stages)
right_ha <- ComplexHeatmap::rowAnnotation(stage = names(stages_palette), col = list(stage = stages_palette), show_legend = FALSE, show_annotation_name = FALSE)
ComplexHeatmap::Heatmap(z, cluster_rows = FALSE, cluster_columns = FALSE, col = col_fun, right_annotation = right_ha, show_row_names = FALSE, width = grid::unit(ncol(z)*4, 'mm'), height = grid::unit(nrow(z)*4, 'mm'), name = 'enrichment(z)')
devtools::document()
rm(list = c("get_eMatrix"))
devtools::document()
devtools::check()
devtools::build()
devtools::install()
m <- matrix(sample(seq(1,10, length.out=10000), 15000*100, replace = TRUE), ncol = 100)
rownames(m) <- paste0('Gene-', seq(1,15000))
colnames(m) <- paste0('Col-', seq(1,100))
net <- SingleCellExperiment::SingleCellExperiment(assays = list(logcounts = m))
net$SubClass <- rep(c('A', 'B', 'C', 'D'), each = 25)
net$Stages <- rep(c('S1', 'S2', 'S3', 'S4'), each = 25)
stages_palette <- c('S1' = 'pink', 'S2' = 'orange', 'S3' = 'violet', 'S4' = 'black')
net$Stages_color <- stages_palette[net$Stages]
plot_eMatrix(net = net, genes = rownames(net)[seq(1,5)])
library(neuRoDev)
library(neuRoDevDB)
plot_eMatrix(net = net, genes = rownames(net)[seq(1,5)])
corticogenesis_sce <- corticogenesis.sce()
corticogenesis_pe_genes <- read_excel("~/Downloads/preferentially_expressed_gene_list.xlsx", sheet = "corticogenesis")
corticogenesis_pe_genes <- readxl::read_excel("~/Downloads/preferentially_expressed_gene_list.xlsx", sheet = "corticogenesis")
corticogenesis_pe_genes <- apply(corticogenesis_pe_genes, 2, function(i) {i[which(!is.na(i))]})
neuRoDev:::get_average_subclass_vs_stage(corticogenesis_sce, corticogenesis_pe_genes$L6NIT)
net <- corticogenesis_sce
gnees <- corticogenesis_pe_genes$L6NIT
genes <- corticogenesis_pe_genes$L6NIT
genes <- genes[which(genes %in% rownames(net))]
networkByStage <- split_sce_cols(net, net@colData[,"Stages"])
networkByStage <- neuRoDev:::split_sce_cols(net, net@colData[,"Stages"])
o <- lapply(networkByStage, function(i) {
S <- SummarizedExperiment::assays(i)[['logcounts']][genes,]
if(length(genes) == 1) {
S <- (S-mean(S))/stats::sd(S)
return(split(S, i@colData[,"SubClass"]))
}
S <- t(scale(t(S)))
return(split(Matrix::colMeans(S),i@colData[,"SubClass"]))
}
)
o <- lapply(networkByStage, function(i) {
print(1)
S <- SummarizedExperiment::assays(i)[['logcounts']][genes,]
if(length(genes) == 1) {
S <- (S-mean(S))/stats::sd(S)
return(split(S, i@colData[,"SubClass"]))
}
S <- t(scale(t(S)))
return(split(Matrix::colMeans(S),i@colData[,"SubClass"]))
})
i <- networkByStage[[1]]
i
S <- SummarizedExperiment::assays(i)[['logcounts']][genes,]
S
length(genes)
if(length(genes) == 1) {
S <- (S-mean(S))/stats::sd(S)
return(split(S, i@colData[,"SubClass"]))
}
S <- t(scale(t(S)))
t(S)
class(S)
S <- t(scale(t(as.matrix(S))))
S
devtools::document()
devtools::build()
devtools::install()
net <- neuRoDevDB::gliogenesis.sce()
max_size = 3
color_attr = 'SubClass'
label_attr = 'SubClass'
col_vector = NULL
no_label = FALSE
show_edges = TRUE
if(is.null(col_vector)) {
col_vector <- paste0(color_attr, '_color')
}
if(is.character(label_attr) && length(label_attr) == 1 &&  label_attr %in% colnames(SingleCellExperiment::colData(net))) {
label_attr <- SingleCellExperiment::colData(net)[,label_attr]
}
label_attr
as.vector(label_attr)
if(is.character(label_attr) && length(label_attr) == 1 &&  label_attr %in% colnames(SingleCellExperiment::colData(net))) {
label_attr <- as.vector(SingleCellExperiment::colData(net)[,label_attr])
}
if(is.character(color_attr) && length(color_attr) == 1 &&  color_attr %in% colnames(SingleCellExperiment::colData(net))) {
color_attr <- as.vector(SingleCellExperiment::colData(net)[,color_attr])
}
if(is.character(label_attr) && length(label_attr) == 1 &&  label_attr %in% colnames(SingleCellExperiment::colData(net))) {
label_attr <- SingleCellExperiment::colData(net)[,label_attr]
}
if(is.character(color_attr) && length(color_attr) == 1 &&  color_attr %in% colnames(SingleCellExperiment::colData(net))) {
color_attr <- SingleCellExperiment::colData(net)[,color_attr]
}
if(is.character(col_vector) && length(col_vector) == 1 &&  col_vector %in% colnames(SingleCellExperiment::colData(net))) {
col_vector <- as.vector(SingleCellExperiment::colData(net)[,col_vector])
}
names(col_vector) <- color_attr
if(no_label) {
label_attr <- NULL
}
if(length(col_vector) == 1) {
if(is.character(col_vector)) {
col_vector <- Polychrome::createPalette(N = length(unique(color_attr))+2, seedcolors = c('#FF0000', '#FFFFFF'))
col_vector <- col_vector[seq(2,length(col_vector))]
names(col_vector) <- unique(color_attr)
col_vector <- col_vector[color_attr]
} else {
col_vector <- rep(col_vector, length(color_attr))
names(col_vector) <- color_attr
}
}
layout <- cbind(net$X_coord, net$Y_coord)
rownames(layout) <- colnames(net)
layout <- cbind(layout, Size = max(max_size, 100/dim(layout)[1]))
edges <- net@metadata$network$edges
if(!show_edges) {
edges <- NULL
}
layout <- cbind(layout, Colors = col_vector[as.character(color_attr)])
layout <- cbind(layout, Group = color_attr)
if(!is.null(label_attr)) {
layout <- cbind(layout, SubGroup = label_attr)
}
ord <- order(match(layout[,"Group"], names(col_vector)))
layout <- layout[ord,]
p <- plot_net(layout,
color_attr = layout[,"Group"],
label_attr = label_attr[ord],
edges = edges,
show_edges = show_edges,
...)
p <- neuRoDev:::plot_net(layout,
color_attr = layout[,"Group"],
label_attr = label_attr[ord],
edges = edges,
show_edges = show_edges,
...)
p <- neuRoDev:::plot_net(layout,
color_attr = layout[,"Group"],
label_attr = label_attr[ord],
edges = edges,
show_edges = show_edges)
p
label_attr
color_attr = 'SubClass'
label_attr = 'SubClass'
if(is.character(label_attr) && length(label_attr) == 1 &&  label_attr %in% colnames(SingleCellExperiment::colData(net))) {
label_attr <- SingleCellExperiment::colData(net)[,label_attr]
}
label_attr
if(is.character(color_attr) && length(color_attr) == 1 &&  color_attr %in% colnames(SingleCellExperiment::colData(net))) {
color_attr <- SingleCellExperiment::colData(net)[,color_attr]
}
color_attr
color_attr <- as.vector(color_attr)
label_attr <- as.vector(label_attr)
color_attr
label_attr
if(is.character(col_vector) && length(col_vector) == 1 &&  col_vector %in% colnames(SingleCellExperiment::colData(net))) {
col_vector <- as.vector(SingleCellExperiment::colData(net)[,col_vector])
}
names(col_vector) <- color_attr
if(no_label) {
label_attr <- NULL
}
if(length(col_vector) == 1) {
if(is.character(col_vector)) {
col_vector <- Polychrome::createPalette(N = length(unique(color_attr))+2, seedcolors = c('#FF0000', '#FFFFFF'))
col_vector <- col_vector[seq(2,length(col_vector))]
names(col_vector) <- unique(color_attr)
col_vector <- col_vector[color_attr]
} else {
col_vector <- rep(col_vector, length(color_attr))
names(col_vector) <- color_attr
}
}
layout <- cbind(net$X_coord, net$Y_coord)
rownames(layout) <- colnames(net)
layout <- cbind(layout, Size = max(max_size, 100/dim(layout)[1]))
edges <- net@metadata$network$edges
if(!show_edges) {
edges <- NULL
}
layout <- cbind(layout, Colors = col_vector[as.character(color_attr)])
layout <- cbind(layout, Group = color_attr)
if(!is.null(label_attr)) {
layout <- cbind(layout, SubGroup = label_attr)
}
ord <- order(match(layout[,"Group"], names(col_vector)))
layout <- layout[ord,]
p <- plot_net(layout,
color_attr = layout[,"Group"],
label_attr = label_attr[ord],
edges = edges,
show_edges = show_edges,
...)
p <- neuRoDev:::plot_net(layout,
color_attr = layout[,"Group"],
label_attr = label_attr[ord],
edges = edges,
show_edges = show_edges)
p
label_attr
color_attr
names(col_vector)
col_vector
Polychrome::swatch(col_vector)
Polychrome::swatch(col_vector[1:10])
unique(col_vector)
unique(names(col_vectr))
unique(names(col_vector))
prova <- unique(col_vector)
names(prova) <- unique(names(col_vector))
Polychrome::swatch(prova)
riprova <- unique(as.vector(net$SubClass_color))
names(riprova) <- unique(as.vector(net$SubClass))
Polychrome::swatch(riprova)
net$SubClass_color
net$SubClass[1:10]
library(neuRoDev)
plot_eTrace
library(neuRoDev)
plot_eTrace(net, 'GFAP')
plotNetworkScore(net, 'GFAP', label_attr = 'SubClass')
